<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to R Programming</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to R Programming" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to R Programming" />
  
  <meta name="twitter:description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses." />
  

<meta name="author" content="DSCOE Team">


<meta name="date" content="2017-09-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basic-visualization.html">
<link rel="next" href="introduction-to-dates-in-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to R Programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Basic Data Structures</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-programming-language"><i class="fa fa-check"></i><b>1.1</b> The R Programming Language</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#r-or-python"><i class="fa fa-check"></i><b>1.1.1</b> R or Python?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-environment-and-workspace"><i class="fa fa-check"></i><b>1.3</b> R Environment and Workspace</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data Types</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#data-structures"><i class="fa fa-check"></i><b>1.5</b> Data Structures</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#vector-data-structure"><i class="fa fa-check"></i><b>1.5.1</b> Vector Data Structure</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#data-frame-data-structure"><i class="fa fa-check"></i><b>1.5.2</b> Data Frame Data Structure</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#list-data-structure"><i class="fa fa-check"></i><b>1.5.3</b> List Data Structure</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#matrix-data-structure"><i class="fa fa-check"></i><b>1.5.4</b> Matrix Data Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#inputoutput-data"><i class="fa fa-check"></i><b>1.6</b> Input/Output Data</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting Help</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#practice-problem"><i class="fa fa-check"></i><b>1.8</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html"><i class="fa fa-check"></i><b>2</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#cell-level-data-access"><i class="fa fa-check"></i><b>2.2</b> Cell-level Data Access</a></li>
<li class="chapter" data-level="2.3" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#table-command-and-an-example-of-data-cleaning"><i class="fa fa-check"></i><b>2.3</b> <code>table()</code> Command (and an example of data “cleaning”)</a></li>
<li class="chapter" data-level="2.4" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#filter-or-subset-data"><i class="fa fa-check"></i><b>2.4</b> Filter (or subset) data</a></li>
<li class="chapter" data-level="2.5" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#using-the-grep-and-aggregate-commands"><i class="fa fa-check"></i><b>2.5</b> Using the grep and aggregate commands</a></li>
<li class="chapter" data-level="2.6" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#summary"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#practice-problem-1"><i class="fa fa-check"></i><b>2.7</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-visualization.html"><a href="basic-visualization.html"><i class="fa fa-check"></i><b>3</b> Basic Visualization</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-visualization.html"><a href="basic-visualization.html#bar-plot"><i class="fa fa-check"></i><b>3.1</b> Bar Plot</a></li>
<li class="chapter" data-level="3.2" data-path="basic-visualization.html"><a href="basic-visualization.html#pie-chart"><i class="fa fa-check"></i><b>3.2</b> Pie Chart</a></li>
<li class="chapter" data-level="3.3" data-path="basic-visualization.html"><a href="basic-visualization.html#histogram-plot"><i class="fa fa-check"></i><b>3.3</b> Histogram Plot</a></li>
<li class="chapter" data-level="3.4" data-path="basic-visualization.html"><a href="basic-visualization.html#time-series-plot"><i class="fa fa-check"></i><b>3.4</b> Time Series Plot</a></li>
<li class="chapter" data-level="3.5" data-path="basic-visualization.html"><a href="basic-visualization.html#practice-problem-2"><i class="fa fa-check"></i><b>3.5</b> Practice Problem</a><ul>
<li class="chapter" data-level="3.5.1" data-path="basic-visualization.html"><a href="basic-visualization.html#hint-1"><i class="fa fa-check"></i><b>3.5.1</b> Hint #1</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-visualization.html"><a href="basic-visualization.html#hint-2"><i class="fa fa-check"></i><b>3.5.2</b> Hint #2</a></li>
<li class="chapter" data-level="3.5.3" data-path="basic-visualization.html"><a href="basic-visualization.html#hint-3"><i class="fa fa-check"></i><b>3.5.3</b> Hint #3</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic-visualization.html"><a href="basic-visualization.html#hint-4"><i class="fa fa-check"></i><b>3.5.4</b> Hint #4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html"><i class="fa fa-check"></i><b>4</b> Introduction to Control Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#if-statements"><i class="fa fa-check"></i><b>4.1</b> if() Statements</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#loops"><i class="fa fa-check"></i><b>4.2</b> Loops</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#practice-problem-3"><i class="fa fa-check"></i><b>4.3</b> Practice Problem</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#hint-1-1"><i class="fa fa-check"></i><b>4.3.1</b> Hint #1</a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#hint-2-1"><i class="fa fa-check"></i><b>4.3.2</b> Hint #2</a></li>
<li class="chapter" data-level="4.3.3" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#hint-3-1"><i class="fa fa-check"></i><b>4.3.3</b> Hint #3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html"><i class="fa fa-check"></i><b>5</b> Introduction to Dates in R</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#dates-with-base-r"><i class="fa fa-check"></i><b>5.1</b> Dates with Base R</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#dates-with-the-lubridate-package"><i class="fa fa-check"></i><b>5.2</b> Dates with the Lubridate Package</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#posixct-and-posixlt"><i class="fa fa-check"></i><b>5.3</b> POSIXct and POSIXlt</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exam.html"><a href="exam.html"><i class="fa fa-check"></i><b>6</b> Exam</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-control-structures" class="section level1">
<h1><span class="header-section-number">Lesson: 4</span> Introduction to Control Structures</h1>
<p>This lesson will cover the <code>if()</code> statement as well as the <code>for()</code> loop and <code>while()</code> loop. These are three very common control structures for all computer programming languages and are used extensively in the R programming language.</p>
<div id="if-statements" class="section level2">
<h2><span class="header-section-number">4.1</span> if() Statements</h2>
<p>The <code>if()</code> statement allows us to automate decision points and guide the computer through a data flow diagram. The basic syntax is given below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(&lt;condition&gt;) {
  <span class="co"># do something</span>
} else if(&lt;another condition&gt;){
  <span class="co"># do something else</span>
} else {
  <span class="co"># do something completely different</span>
}</code></pre></div>
<p>Let’s see this in practice:</p>
<ul>
<li>Case 1</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.number =<span class="st"> </span><span class="dv">1</span>
if(!<span class="kw">is.numeric</span>(my.number)) {
  <span class="kw">print</span>(<span class="st">&quot;You were supposed to store a number in &#39;my.number&#39;.&quot;</span>)
} else if(my.number &gt;=<span class="st"> </span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="st">&quot;My number is greater than or equal to 10.&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;My number is less than 10.&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;My number is less than 10.&quot;</code></pre>
<ul>
<li>Case 2</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.number =<span class="st"> </span><span class="dv">100</span>
if(!<span class="kw">is.numeric</span>(my.number)) {
  <span class="kw">print</span>(<span class="st">&quot;You were supposed to store a number in &#39;my.number&#39;.&quot;</span>)
} else if(my.number &gt;=<span class="st"> </span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="st">&quot;My number is greater than or equal to 10.&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;My number is less than 10.&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;My number is greater than or equal to 10.&quot;</code></pre>
<ul>
<li>Case 3</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.number =<span class="st"> &quot;huge&quot;</span>
if(!<span class="kw">is.numeric</span>(my.number)) {
  <span class="kw">print</span>(<span class="st">&quot;You were supposed to store a number in &#39;my.number&#39;.&quot;</span>)
} else if(my.number &gt;=<span class="st"> </span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="st">&quot;My number is greater than or equal to 10.&quot;</span>)
} else {
  <span class="kw">print</span>(<span class="st">&quot;My number is less than 10.&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;You were supposed to store a number in &#39;my.number&#39;.&quot;</code></pre>
<p>The <code>else</code> clause(s) can grow rather lengthy if many special cases must be handled uniquely, but it is quite often the case that we just need an <code>if()</code> statement. Think of this statement as a gate you must pass in order to run a chunk of code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(&lt;condition&gt;) {
  ## do something
}</code></pre></div>
<p>An example you might use in practice is boundary checking. Suppose you have age data, and you want to be notified if there is a negative age recorded.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.age &lt;-<span class="st"> </span><span class="dv">1</span>
if(my.age &lt;<span class="st"> </span><span class="dv">0</span>) {
  <span class="kw">print</span>(<span class="st">&quot;Negative age detected.  Check for data entry error.&quot;</span>)
}</code></pre></div>
<p>We didn’t see our notification because we didn’t pass the <code>if()</code> gate that reaches the <code>print()</code> command. We skipped right over it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.age &lt;-<span class="st"> </span>-<span class="dv">1</span>
if(my.age &lt;<span class="st"> </span><span class="dv">0</span>) {
  <span class="kw">print</span>(<span class="st">&quot;Negative age detected.  Check for data entry error.&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;Negative age detected.  Check for data entry error.&quot;</code></pre>
<p>Now we get the message because we passed the <code>if()</code> condition.</p>
<p>The <code>if()</code> statement is most often used in <em>loops</em> and <em>functions</em>. We’ll illustrate the use of the <code>if()</code> statement in <em>loops</em> below.</p>
</div>
<div id="loops" class="section level2">
<h2><span class="header-section-number">4.2</span> Loops</h2>
<p>Loops provide a way to systematically walk down a data structure (usually a vector, data frame, or list) and potentially accomplish a task many times along the way. The <code>for()</code> loop and the <code>while()</code> loop will be the primary loops used in this class. The <code>for()</code> loop is used when we know ahead of time a finite number of iterations that we need to execute. For example, we might execute a task for every object in a vector/list or every row in a data frame.</p>
<p>The <code>for()</code> loop below iterates over the values 1, 2, 3, 4, and 5 and prints each of the values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for(i in <span class="dv">1</span>:<span class="dv">5</span>){
  <span class="kw">print</span>(i)
}</code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<p>Notice that we can also use <code>i</code> to access a value in a vector, a row in a data frame, or an object in a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>)
for(i in <span class="dv">1</span>:<span class="dv">5</span>){
  <span class="kw">print</span>(letters[i])
}</code></pre></div>
<pre><code>## [1] &quot;a&quot;
## [1] &quot;b&quot;
## [1] &quot;c&quot;
## [1] &quot;d&quot;
## [1] &quot;e&quot;</code></pre>
<p>You also don’t have to start with 1 or use the letter <em>i</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for (year in <span class="dv">2010</span>:<span class="dv">2015</span>){
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The year is&quot;</span>, year))
}</code></pre></div>
<pre><code>## [1] &quot;The year is 2010&quot;
## [1] &quot;The year is 2011&quot;
## [1] &quot;The year is 2012&quot;
## [1] &quot;The year is 2013&quot;
## [1] &quot;The year is 2014&quot;
## [1] &quot;The year is 2015&quot;</code></pre>
<p>The <code>next</code> command is often used to skip an iteration if a certain condition is met. The code below illustrates how to use <code>next</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for(i in <span class="dv">1</span>:<span class="dv">5</span>){
  if(letters[i]==<span class="st">&quot;c&quot;</span>){
    next
  }
  <span class="kw">print</span>(letters[i])
}</code></pre></div>
<pre><code>## [1] &quot;a&quot;
## [1] &quot;b&quot;
## [1] &quot;d&quot;
## [1] &quot;e&quot;</code></pre>
<p>Loops can also be nested inside of each other. This is useful when working with multiple dimensions (like matrices) or lists of lists. For example, the outer <code>for()</code> loop iterates over countries, and the inner <code>for()</code> loop iterates over each city in a given country. An example of a nested <code>for()</code> loop is given below, creating a multiplication table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nested for: multiplication table</span>
<span class="co"># create a 10 x 10 matrix (10 rows and 10 columns)</span>
mymat =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">10</span>, <span class="dt">ncol=</span><span class="dv">10</span>) 

for(i in <span class="dv">1</span>:<span class="kw">nrow</span>(mymat)) {  <span class="co"># for each row</span>
  for(j in <span class="dv">1</span>:<span class="kw">ncol</span>(mymat)){ <span class="co"># for each column</span>
    <span class="co"># assign values based on position: product of two indices</span>
    mymat[i,j] =<span class="st"> </span>i*j     
  }
}

mymat</code></pre></div>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
##  [1,]    1    2    3    4    5    6    7    8    9    10
##  [2,]    2    4    6    8   10   12   14   16   18    20
##  [3,]    3    6    9   12   15   18   21   24   27    30
##  [4,]    4    8   12   16   20   24   28   32   36    40
##  [5,]    5   10   15   20   25   30   35   40   45    50
##  [6,]    6   12   18   24   30   36   42   48   54    60
##  [7,]    7   14   21   28   35   42   49   56   63    70
##  [8,]    8   16   24   32   40   48   56   64   72    80
##  [9,]    9   18   27   36   45   54   63   72   81    90
## [10,]   10   20   30   40   50   60   70   80   90   100</code></pre>
<p>The <code>while()</code> loop is used when we don’t know how many iterations we need to go through, but we know the condition that needs to be met before we are done.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i &lt;-<span class="st"> </span><span class="dv">5</span>
while(i &lt;=<span class="st"> </span><span class="dv">25</span>) {
  <span class="kw">print</span>(i)
  <span class="co"># Here we set a new value of i.</span>
  i &lt;-<span class="st"> </span>i +<span class="st"> </span><span class="dv">5</span>
  <span class="co"># Now we go back and check the while() condition.</span>
}</code></pre></div>
<pre><code>## [1] 5
## [1] 10
## [1] 15
## [1] 20
## [1] 25</code></pre>
<p>To finish out this lesson, we’ll provide an example of some more sophisticated code. This function simulates a round of play in the board game <em>RISK</em>. In the board game <em>RISK</em>, an attacker begins an assault against a defender, and the win/loss is adjudicated as both players begin rolling dice and comparing values. The simulation below plays through this entire series, declares whether the attacker or the defender won, and declares the number of armies left on the board for each player. Instead of doing this once, this code plays through this 10,000 times, and in the process calculates the probability of the <em>attacker</em> winning. This type of process is known as Monte Carlo Simulation. While you may not fully understand all aspects of this code, note throughout this function how important <em>loops</em> and <code>if()</code> statements are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Our function will take as inputs the number of armies the </span>
<span class="co"># attacker has, the number of armies the defender has, and </span>
<span class="co"># the desired number of simulated trials the user wants.</span>
risk &lt;-<span class="st"> </span>function(attacker, defender, n) {
  <span class="co"># Create an empty vector to hold the simulated win/loss outcomes.</span>
  results &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n)
  <span class="co"># Create restoration values to reset the armies after each trial.</span>
  attacker.reset &lt;-<span class="st"> </span>attacker
  defender.reset &lt;-<span class="st"> </span>defender
  <span class="co"># For n total trials... </span>
  for(j in <span class="dv">1</span>:n){
    <span class="co"># Reset the attacker and defender for a new trial.</span>
    attacker &lt;-<span class="st"> </span>attacker.reset
    defender &lt;-<span class="st"> </span>defender.reset
    <span class="co"># ...as long as the attacker has more than one army</span>
    <span class="co"># and the defender has an army...</span>
    while(attacker &gt;<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>defender &gt;<span class="st"> </span><span class="dv">0</span>) {
      <span class="co"># Both players pick up the right number of dice...</span>
      atk.dice &lt;-<span class="st"> </span><span class="kw">min</span>(attacker<span class="dv">-1</span>, <span class="dv">3</span>)
      def.dice &lt;-<span class="st"> </span><span class="kw">min</span>(defender, <span class="dv">2</span>)
      <span class="co"># Both players roll the right number of dice...</span>
      atk.roll &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">runif</span>(atk.dice)*<span class="dv">6</span>)
      def.roll &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">runif</span>(def.dice)*<span class="dv">6</span>)
      <span class="co"># Each player&#39;s dice are sorted from greatest to least...</span>
      atk.roll &lt;-<span class="st"> </span>atk.roll[<span class="kw">order</span>(atk.roll,<span class="dt">decreasing=</span>T)]
      def.roll &lt;-<span class="st"> </span>def.roll[<span class="kw">order</span>(def.roll,<span class="dt">decreasing=</span>T)]
      <span class="co"># Compare the correct numbers of dice for each player...</span>
      comparison &lt;-<span class="st"> </span><span class="kw">min</span>(atk.dice, def.dice)
      for (i in <span class="dv">1</span>:comparison) {
        if (atk.roll[i] &gt;<span class="st"> </span>def.roll[i]){
          <span class="co"># The attacker won, so the defender loses an army...</span>
          defender &lt;-<span class="st"> </span>defender<span class="dv">-1</span>
        }
        if (atk.roll[i] &lt;=<span class="st"> </span>def.roll[i]){
          <span class="co"># The defender won, so the attacker loses an army...</span>
          attacker &lt;-<span class="st"> </span>attacker<span class="dv">-1</span>
        }
        <span class="co"># Keep going up to the number of required comparisons.</span>
      }
      <span class="co"># Keep going until the attacker or defender is wiped out.</span>
    }
    <span class="co"># If the defender ran out of armies, the attacker wins.</span>
    if (defender==<span class="dv">0</span>) results[j] &lt;-<span class="st"> &quot;Attacker&quot;</span>
    <span class="co"># If the defender did not run out of armies, the defender wins.</span>
    if (defender&gt;<span class="dv">0</span>) results[j] &lt;-<span class="st"> &quot;Defender&quot;</span>
    <span class="co"># Keep going up to the number of required trials.</span>
  }
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The Probability of the Attacker winning is:&quot;</span>,
              <span class="kw">length</span>(results[results==<span class="st">&quot;Attacker&quot;</span>])/n))
}</code></pre></div>
<p>The statement below illustrates how to use the <code>risk()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">risk</span>(<span class="dt">attacker=</span><span class="dv">4</span>,<span class="dt">defender=</span><span class="dv">3</span>,<span class="dt">n=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## [1] &quot;The Probability of the Attacker winning is: 0.476&quot;</code></pre>
</div>
<div id="practice-problem-3" class="section level2">
<h2><span class="header-section-number">4.3</span> Practice Problem</h2>
<p>Use the instructions below to determine and visualize the average movie rating by genre.</p>
<ul>
<li>Read the movie ratings data you downloaded in Section 1.6 into R.</li>
<li>Use the code below to build a vector called <code>genres</code> that contains all unique genre names contained in the data set.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stringr)
rating &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rating2.csv&quot;</span>, <span class="dt">as.is =</span> <span class="ot">TRUE</span>)
genre.list &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">unlist</span>(<span class="kw">str_split</span>(rating$genres,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">|&quot;</span>)))</code></pre></div>
<p>Try to execute the following steps before looking at the code solution that shows just one way to accomplish this task.</p>
<ul>
<li>Create a vector object that is the same length as <code>genre.list</code> to contain the <code>mean</code> ratings.</li>
<li>Iterate over your original data set in a <code>for()</code> loop, use the <code>grep()</code> command to extract the subset that is related to a specific genre, and calculate the mean rating for that genre.</li>
<li>Create a barplot visualization of average ratings by genre.</li>
</ul>
<hr />
<div id="hint-1-1" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Hint #1</h3>
<ul>
<li>Create a vector object that is the same length as <code>genre.list</code> to contain the <code>mean</code> ratings.</li>
</ul>
<p>The <code>rep()</code> command replicates a value or set of values a specified number of times. The <code>length()</code> command returns the number of elements in a vector or list object. We can use these two functions to create a vector of the correct length.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We&#39;ll replicate NA as our placeholder to be replaced by actual numbers.</span>
mean.ratings &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">length</span>(genre.list))</code></pre></div>
<hr />
</div>
<div id="hint-2-1" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Hint #2</h3>
<ul>
<li>Iterate over your original data set in a <code>for()</code> loop, use the <code>grep()</code> command to extract the subset that is related to a specific genre, and calculate the mean rating for that genre. Note that many movies are classified as belonging to multiple genres, and we will allow each movie’s rating to contribute to the calculation of the mean rating for any genre to which it belongs.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># It appears most movies are associated with multiple genres.</span>
<span class="kw">head</span>(rating$genres)</code></pre></div>
<pre><code>## [1] &quot;Adventure|Animation|Children|Comedy|Fantasy&quot;    
## [2] &quot;Action|Drama|War&quot;                               
## [3] &quot;Action|Adventure|Sci-Fi&quot;                        
## [4] &quot;Adventure|Animation|Children|Drama|Musical|IMAX&quot;
## [5] &quot;Drama|War&quot;                                      
## [6] &quot;Adventure|Animation|Children|Comedy|Musical&quot;</code></pre>
<p>We might be tempted to set up our <code>for()</code> loop from <code>1:length(rating)</code>, but that would only loop over the 7 objects inside our <code>rating</code> data frame. We might also be tempted to loop over the 283,886 movies, which we can do by looping over any column of <code>rating</code> (e.g, <code>1:length(rating$title)</code>. What we really want to do is loop over our vector of genres (i.e., <code>1:length(genre.list)</code>). This approach will let us complete an assessment of each genre all at once instead of moving through our list movie by movie.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We&#39;ll iterate over our vector of genres.</span>
for(i in <span class="dv">1</span>:<span class="kw">length</span>(genre.list)){
  <span class="co"># Let&#39;s filter out any movies that don&#39;t belong to the genre of interest.</span>
  <span class="co"># First identify which movie indices correspond to the genre of interest.</span>
  this.genre.indices &lt;-<span class="st"> </span><span class="kw">grep</span>(genre.list[i],rating$genres)
  <span class="co"># Now let&#39;s compute and store the mean rating of this genre.</span>
  <span class="co"># We&#39;ll compute the mean of &quot;rating&quot; column in the rows we just identifed.</span>
  mean.ratings[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(rating[this.genre.indices,<span class="st">&quot;rating&quot;</span>])
}</code></pre></div>
<p>Now we have a vector of mean ratings, which we can combine with the genre list into a data frame and display as text here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.rating &lt;-<span class="st"> </span><span class="kw">data.frame</span>(genre.list,mean.ratings)
df.rating</code></pre></div>
<pre><code>##            genre.list mean.ratings
## 1           Adventure     3.481759
## 2           Animation     3.579487
## 3            Children     3.420384
## 4              Comedy     3.358041
## 5             Fantasy     3.464419
## 6              Action     3.452660
## 7               Drama     3.641138
## 8                 War     3.690831
## 9              Sci-Fi     3.499506
## 10            Musical     3.521342
## 11               IMAX     3.524784
## 12            Romance     3.457683
## 13             Horror     3.261698
## 14           Thriller     3.502560
## 15              Crime     3.654538
## 16            Western     3.601346
## 17            Mystery     3.639658
## 18        Documentary     3.552925
## 19          Film-Noir     3.780648
## 20 (no genres listed)     2.929924</code></pre>
<hr />
</div>
<div id="hint-3-1" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Hint #3</h3>
<ul>
<li>Create a barplot visualization of average ratings by genre.</li>
</ul>
<p>We already wrote some code to do exactly this with our Olympic medal data. Let’s repurpose our old code and adjust it as necessary. Don’t reinvent the wheel!</p>
<p>Note: You’ll see the argument <code>stat=&quot;identity&quot;</code> in the <code>geom_bar()</code> command. You have the option to let R compute means, counts, etc., from our chosen y-data. In our case, we already did that. The <code>&quot;identity&quot;</code> option means we just want the values to be presented exactly as we’ve provided them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(df.rating, <span class="kw">aes</span>(<span class="dt">x=</span>genre.list,<span class="dt">y=</span>mean.ratings)) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Mean Movie Rating by Genre&#39;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Mean Rating&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Movie Genres&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-dates-in-r.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-control.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
