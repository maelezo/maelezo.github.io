<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to R Programming</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to R Programming" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to R Programming" />
  
  <meta name="twitter:description" content="This is an introduction to R programming, and it will be used as the prerequisite for several data science courses." />
  

<meta name="author" content="DSCOE Team">


<meta name="date" content="2017-08-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basic-data-manipulation.html">
<link rel="next" href="introduction-to-control-structures.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to R Programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Basic Data Structures</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-programming-language"><i class="fa fa-check"></i><b>1.1</b> The R Programming Language</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#r-or-python"><i class="fa fa-check"></i><b>1.1.1</b> R or Python?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-environment-and-workspace"><i class="fa fa-check"></i><b>1.3</b> R Environment and Workspace</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data Types</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#data-structures"><i class="fa fa-check"></i><b>1.5</b> Data Structures</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#vector-data-structure"><i class="fa fa-check"></i><b>1.5.1</b> Vector Data Structure</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#data-frame-data-structure"><i class="fa fa-check"></i><b>1.5.2</b> Data Frame Data Structure</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#list-data-structure"><i class="fa fa-check"></i><b>1.5.3</b> List Data Structure</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#matrix-data-structure"><i class="fa fa-check"></i><b>1.5.4</b> Matrix Data Structure</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#inputoutput-data"><i class="fa fa-check"></i><b>1.6</b> Input/Output Data</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting Help</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#practice-problem"><i class="fa fa-check"></i><b>1.8</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html"><i class="fa fa-check"></i><b>2</b> Basic Data Manipulation</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#cell-level-data-access"><i class="fa fa-check"></i><b>2.2</b> Cell-level Data Access</a></li>
<li class="chapter" data-level="2.3" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#table-command-and-an-example-of-data-cleaning"><i class="fa fa-check"></i><b>2.3</b> <code>Table</code> Command (and an example of data “cleaning”)</a></li>
<li class="chapter" data-level="2.4" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#filter-or-subset-data"><i class="fa fa-check"></i><b>2.4</b> Filter (or subset) data</a></li>
<li class="chapter" data-level="2.5" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#using-the-grep-and-aggregate-commands"><i class="fa fa-check"></i><b>2.5</b> Using the grep and aggregate commands</a></li>
<li class="chapter" data-level="2.6" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#summary"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="basic-data-manipulation.html"><a href="basic-data-manipulation.html#practice-problem-1"><i class="fa fa-check"></i><b>2.7</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-visualization.html"><a href="basic-visualization.html"><i class="fa fa-check"></i><b>3</b> Basic Visualization</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-visualization.html"><a href="basic-visualization.html#bar-plot"><i class="fa fa-check"></i><b>3.1</b> Bar Plot</a></li>
<li class="chapter" data-level="3.2" data-path="basic-visualization.html"><a href="basic-visualization.html#pie-chart"><i class="fa fa-check"></i><b>3.2</b> Pie Chart</a></li>
<li class="chapter" data-level="3.3" data-path="basic-visualization.html"><a href="basic-visualization.html#histogram-plot"><i class="fa fa-check"></i><b>3.3</b> Histogram Plot</a></li>
<li class="chapter" data-level="3.4" data-path="basic-visualization.html"><a href="basic-visualization.html#time-series-plot"><i class="fa fa-check"></i><b>3.4</b> Time Series Plot</a></li>
<li class="chapter" data-level="3.5" data-path="basic-visualization.html"><a href="basic-visualization.html#practice-problem-2"><i class="fa fa-check"></i><b>3.5</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html"><i class="fa fa-check"></i><b>4</b> Introduction to Control Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#if-statements"><i class="fa fa-check"></i><b>4.1</b> if() Statements</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#loops"><i class="fa fa-check"></i><b>4.2</b> Loops</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-control-structures.html"><a href="introduction-to-control-structures.html#practice-problem-3"><i class="fa fa-check"></i><b>4.3</b> Practice Problem</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html"><i class="fa fa-check"></i><b>5</b> Introduction to Dates in R</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#dates-with-base-r"><i class="fa fa-check"></i><b>5.1</b> Dates with Base R</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#dates-with-the-lubridate-package"><i class="fa fa-check"></i><b>5.2</b> Dates with the Lubridate Package</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-dates-in-r.html"><a href="introduction-to-dates-in-r.html#posixct-and-posixlt"><i class="fa fa-check"></i><b>5.3</b> POSIXct and POSIXlt</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exam.html"><a href="exam.html"><i class="fa fa-check"></i><b>6</b> Exam</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-visualization" class="section level1">
<h1><span class="header-section-number">Lesson: 3</span> Basic Visualization</h1>
<p>The R programming language has some of the most powerful data visualization packages available. These packages are continually expanded upon, with new data visualization packages being created on a regular basis. In addition to packages that create your basic statistical visualization (line plots, bar plots, pie charts, etc.) there are packages that create geospatial visualizations, 3D visualizations, and interactive visualizations.</p>
<p>Let’s start by reading in the Korean Conflict data and performing the primary cleaning functions that we performed last lesson.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kor &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;KoreanConflict.csv&#39;</span>, <span class="dt">as.is=</span><span class="ot">TRUE</span>)
kor$BIRTH_YEAR &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(kor$BIRTH_YEAR)
kor &lt;-<span class="st"> </span>kor[!<span class="kw">is.na</span>(kor$BIRTH_YEAR),]</code></pre></div>
<p>Now that we have the data in memory, we will use some basic visualizations to explore the data. In this lesson, we will primarily use visualizations from the ggplot2 package <span class="citation">(Wickham and Chang <a href="#ref-R-ggplot2">2017</a>)</span>. If you haven’t installed this package yet, run the command <code>install.packages('ggplot2')</code>.</p>
<div id="bar-plot" class="section level2">
<h2><span class="header-section-number">3.1</span> Bar Plot</h2>
<p>We will start by producing a basic barplot of categorical variables. First we’ll look at the <code>BRANCH</code> field for the Korean Casualties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(BRANCH)) +<span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Let’s break down what this command is actually doing. The <code>ggplot</code> command is the start of any <code>ggplot2</code> visualization. In this <code>ggplot()</code> command, we say that we want a visualization of the <code>kor</code> data set with a focus on the <code>BRANCH</code> variable, referred to as the <em>aesthetic</em> (aes) in the <code>ggplot2</code> package. The next command says to take the data we’ve identified (<code>BRANCH</code> variable from the <code>kor</code> data frame) and create a barplot (<code>geom_</code> specifies the geometry or shape/style of plot we want).</p>
<p>We can uniquely color the bars by adding <code>fill = BRANCH</code> to specify that each bar’s fill color should be associated with the <code>BRANCH</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(BRANCH, <span class="dt">fill =</span> BRANCH)) +<span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>We may also want to add a title and get rid of the legend since the labels are already on the horizontal axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(BRANCH, <span class="dt">fill =</span> BRANCH)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Casualties by Service&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>This plot is starting to look pretty nice, but centering the title and capitalizing the vertical axis label would be good finishing touches. While the code below may look complicated, a quick internet search will produce a “how-to” for just about any plot modification you can imagine. As an example, perform a Google search for “center a ggtitle” (you should find the solution below in the first linked search result).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(BRANCH, <span class="dt">fill =</span> BRANCH)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Casualties by Service&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>As we continued adding more and more pieces to our plot command, you’ll notice each piece was simply connected with the <code>+</code> operator. The “gg” in “ggplot” stands for “grammar of graphics,” and you can think about each component of our plot command being an aspect of a sentence. We first defined the subject when we specified <code>kor</code> and <code>BRANCH</code>. We added the “what” and “how” when we instructed R to build a certain type of plot in a certain way. Think about this “grammar of graphics” structure as we continue to build more and more complex and tailorable visualizations.</p>
<p>Now let’s build a stacked barplot. Say we wanted to see the distribution of <code>ETHNICITY</code> in each of the service <code>BRANCHES</code>. First, let’s take a look at our categories:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(kor$ETHNICITY_2)</code></pre></div>
<pre><code>## 
##             AMERICAN INDIAN/ALASKA NATIVE 
##                                       103 
##                                     ASIAN 
##                                       229 
##                 BLACK OR AFRICAN AMERICAN 
##                                      1146 
##                 BLACK OR AFRICAN AMERICAN 
##                                      3022 
##                         HISPANIC ONE RACE 
##                                       566 
## NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER 
##                                       142 
##                                     WHITE 
##                                     28691</code></pre>
<p>These are rather long names to display on a chart. We will start by creating shorter names. We can do this in the code below using the ``grep command that we learned in Lesson 2. We can replace “Native Hawaiian or other Pacific Islander” with simply “Pacific Islander” as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kor$ETHNICITY_2[<span class="kw">grep</span>(<span class="st">&quot;HAWAIIAN&quot;</span>,kor$ETHNICITY_2)] &lt;-<span class="st"> &quot;PACIFIC ISLANDER&quot;</span></code></pre></div>
<p>Now all we have to do to change in our previous code is to change the <code>fill = BRANCH</code> to <code>fill = ETHNICITY_2</code>. We also don’t want to discard the legend anymore.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(BRANCH, <span class="dt">fill =</span> ETHNICITY_2)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Casualties by Service&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="pie-chart" class="section level2">
<h2><span class="header-section-number">3.2</span> Pie Chart</h2>
<p>Statisticians will generally tell you that you should never use a pie chart (usually a bar plot is recommended because it is easier for the human eye to distinguish differences in magnitude). That being said, there are still a few times when a pie chart is necessary. For this plot, we are going to use a function from the BASE graphics package (this comes with R, and you don’t have to load it). The pie chart is very easy to produce if we wrap the <code>pie()</code> command around the <code>table</code> command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pie</span>(<span class="kw">table</span>(kor$BRANCH), <span class="dt">main =</span> <span class="st">&quot;Korean War Casualties by Service&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
<div id="histogram-plot" class="section level2">
<h2><span class="header-section-number">3.3</span> Histogram Plot</h2>
<p>Now we’ll take a look at several ways to create <em>histograms</em> in R. This is where R will quickly outshine Microsoft Excel and other spreadsheet programs. While Excel can create a barplot just like R, it is extremely time consuming to create a <em>histogram</em> in Excel. R will create a histogram in one line of code.</p>
<p>Let’s create a histogram of the age for each Korean Casualty. Notice that we don’t have a field that has <em>age</em> in it, but we do have the <code>BIRTH_YEAR</code> and <code>FATALITY_YEAR</code>. The calculation below will create a new field that is the <code>AGE</code> of the casualty at death (notice that we remove all records with a <code>FATALITY_DATE</code> after 1960 in order to remove those who were MIA and declared dead at a later time).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filter our MIA</span>
kor2 &lt;-<span class="st"> </span>dplyr::<span class="kw">filter</span>(kor, FATALITY_DATE &lt;<span class="st"> </span><span class="dv">1960</span>) 

<span class="co"># Coerce to numeric</span>
kor2$FATALITY_YEAR &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(kor2$FATALITY_YEAR)  
kor2$BIRTH_YEAR &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(kor2$BIRTH_YEAR)

<span class="co"># Create AGE field</span>
kor2$AGE &lt;-<span class="st"> </span>kor2$FATALITY_YEAR -<span class="st"> </span>kor2$BIRTH_YEAR      </code></pre></div>
<p>Now that we’ve created the <code>AGE</code> field, we will use two different techniques to create a histogram. The Base R package has a histogram function that is easy to use and helpful for exploring data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(kor2$AGE, <span class="dt">freq=</span><span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;Histogram of Age&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;AGE&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>The <code>ggplot2</code> package also has the ability to generate a histogram that is generally better for presentations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(kor2, <span class="kw">aes</span>(AGE)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">16</span>,<span class="dv">50</span>, <span class="dt">by=</span><span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Korean Casualty Age Distribution&#39;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="time-series-plot" class="section level2">
<h2><span class="header-section-number">3.4</span> Time Series Plot</h2>
<p>Time series plots (and line plots in general) are helpful in visually identifying trends and anomalies in data. We are going to change our data sets to look at the Olympic data. This data set is the data on all Olympic medals for the Summer Olympics from 1896 to 2012. This data set is available here:</p>
<p><a href="https://s3.amazonaws.com/dscoe-data-2/summer.csv" class="uri">https://s3.amazonaws.com/dscoe-data-2/summer.csv</a></p>
<p>You can download the file with the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;https://s3.amazonaws.com/dscoe-data-2/summer.csv&quot;</span>, 
              <span class="dt">destfile =</span> <span class="st">&quot;summer.csv&quot;</span>)</code></pre></div>
<p>Now that you’ve acquired the data, read it into R and take a look at its structure with the following two commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oly &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;summer.csv&#39;</span>, <span class="dt">as.is =</span> <span class="ot">TRUE</span>)
<span class="kw">str</span>(oly)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    31165 obs. of  9 variables:
##  $ Year      : int  1896 1896 1896 1896 1896 1896 1896 1896 1896 1896 ...
##  $ City      : chr  &quot;Athens&quot; &quot;Athens&quot; &quot;Athens&quot; &quot;Athens&quot; ...
##  $ Sport     : chr  &quot;Aquatics&quot; &quot;Aquatics&quot; &quot;Aquatics&quot; &quot;Aquatics&quot; ...
##  $ Discipline: chr  &quot;Swimming&quot; &quot;Swimming&quot; &quot;Swimming&quot; &quot;Swimming&quot; ...
##  $ Athlete   : chr  &quot;HAJOS, Alfred&quot; &quot;HERSCHMANN, Otto&quot; &quot;DRIVAS, Dimitrios&quot; &quot;MALOKINIS, Ioannis&quot; ...
##  $ Country   : chr  &quot;HUN&quot; &quot;AUT&quot; &quot;GRE&quot; &quot;GRE&quot; ...
##  $ Gender    : chr  &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; ...
##  $ Event     : chr  &quot;100M Freestyle&quot; &quot;100M Freestyle&quot; &quot;100M Freestyle For Sailors&quot; &quot;100M Freestyle For Sailors&quot; ...
##  $ Medal     : chr  &quot;Gold&quot; &quot;Silver&quot; &quot;Bronze&quot; &quot;Gold&quot; ...</code></pre>
<p>Let’s say that we want to explore the trend of increased numbers of women participating in the Summer Olympics over the past century. The <code>dplyr</code> package offers an <code>aggregate()</code> function that will help us do this. Let’s start by aggregating the number of Olympic medals by <code>Year</code> and <code>Gender</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Take the full list of athletes, split it up into many sublists </span>
<span class="co"># by year and by gender, and return the length of each sublist.</span>
oly_sum &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Athlete ~<span class="st"> </span>Year +<span class="st"> </span>Gender, <span class="dt">data=</span>oly, length)</code></pre></div>
<p>Let’s take a look at the first few and last few lines of this new data set to make sure that it aggregated the data as we anticipated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(oly_sum)</code></pre></div>
<pre><code>##   Year Gender Athlete
## 1 1896    Men     151
## 2 1900    Men     501
## 3 1904    Men     458
## 4 1908    Men     789
## 5 1912    Men     855
## 6 1920    Men    1255</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(oly_sum)</code></pre></div>
<pre><code>##    Year Gender Athlete
## 48 1992  Women     600
## 49 1996  Women     777
## 50 2000  Women     889
## 51 2004  Women     899
## 52 2008  Women     932
## 53 2012  Women     924</code></pre>
<p>A final check for correctness requires us to sum the <code>oly_sum$Athlete</code> counts. If the sum equals the total number of athletes (31,165), that’s a good sign.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(oly_sum$Athlete)</code></pre></div>
<pre><code>## [1] 31165</code></pre>
<p>Everything looks good. Now we have a data set that we can use to create a time series line plot. We create this plot below by specifying <code>Year</code> as our horizontal or x-axis and <code>Athlete</code> as our vertical or y-axis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(oly_sum, <span class="kw">aes</span>(<span class="dt">x=</span>Year, <span class="dt">y=</span>Athlete, <span class="dt">group =</span> Gender, <span class="dt">color =</span> Gender)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Summer Olympic Medals by Gender&#39;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>From this graph we see that there was significant growth in the participation of women in the Olympics starting in the 1970s. We also see an interesting spike in the number of medals for men in the 1920’s that we could explore..</p>
<p>Now let’s select a few of the prominent countries in the Summer Olympics. Specifically, we’ll look at the permanent members of the UN Security Council: United States, Great Britain, France, China, and Russia. Let’s first look at the table of countries listed in the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(oly$Country)</code></pre></div>
<pre><code>## 
##       AFG  AHO  ALG  ANZ  ARG  ARM  AUS  AUT  AZE  BAH  BAR  BDI  BEL  BER 
##    4    2    1   15   29  259   11 1189  146   26   27    1    1  411    1 
##  BLR  BOH  BOT  BRA  BRN  BUL  BWI  CAN  CHI  CHN  CIV  CMR  COL  CRC  CRO 
##  113    7    1  431    1  333    5  649   33  807    1   23   19    4  114 
##  CUB  CYP  CZE  DEN  DJI  DOM  ECU  EGY  ERI  ESP  EST  ETH  EUA  EUN  FIN 
##  410    1   56  507    1    6    2   28    1  442   39   45  260  223  456 
##  FRA  FRG  GAB  GBR  GDR  GEO  GER  GHA  GRE  GRN  GUA  GUY  HAI  HKG  HUN 
## 1396  490    1 1720  825   25 1305   16  148    1    1    1    8    4 1079 
##  INA  IND  IOP  IRI  IRL  IRQ  ISL  ISR  ISV  ITA  JAM  JPN  KAZ  KEN  KGZ 
##   38  184    3   61   30    1   17    7    1 1296  127  788   49   93    3 
##  KOR  KSA  KUW  LAT  LIB  LTU  LUX  MAR  MAS  MDA  MEX  MGL  MKD  MNE  MOZ 
##  529    6    2   20    4   55    2   22    8    6  106   24    1   14    2 
##  MRI  NAM  NED  NGR  NIG  NOR  NZL  PAK  PAN  PAR  PER  PHI  POL  POR  PRK 
##    1    4  851   84    1  554  190  121    3   17   15    9  511   33   58 
##  PUR  QAT  ROU  RSA  RU1  RUS  SCG  SEN  SGP  SIN  SLO  SRB  SRI  SUD  SUI 
##    8    4  640  106   17  768   14    1    4    4   26   31    2    1  380 
##  SUR  SVK  SWE  SYR  TAN  TCH  TGA  THA  TJK  TOG  TPE  TRI  TTO  TUN  TUR 
##    2   34 1044    3    2  329    1   25    3    1   44   20   10   10   86 
##  UAE  UGA  UKR  URS  URU  USA  UZB  VEN  VIE  YUG  ZAM  ZIM  ZZX 
##    1    7  173 2049   76 4585   20   12    2  435    2   23   48</code></pre>
<p>Studying this data a bit, we see that the ISO-3 code for Russia changed from <em>URS</em> to <em>RUS</em> after the fall of the Soviet Union. For our analysis, we will change all <em>USR</em> data to <em>RUS</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oly$Country[oly$Country==<span class="st">&quot;URS&quot;</span>] &lt;-<span class="st"> &quot;RUS&quot;</span></code></pre></div>
<p>Now will will aggregate the data by <code>Year</code> and <code>Country</code> as well as reduce the country list to only those of interest. In the code below, notice how we create a vector of our five countries and then use the <code>%in%</code> function to filter out all countries not contained in our list. In other words, we consider each medal winner and retain that individual record only if his or her country is <em>in</em> our country list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
oly_country &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Medal ~<span class="st"> </span>Country +<span class="st"> </span>Year, <span class="dt">data =</span> oly, length)
country.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;USA&#39;</span>,<span class="st">&#39;GBR&#39;</span>,<span class="st">&#39;FRA&#39;</span>,<span class="st">&#39;CHN&#39;</span>,<span class="st">&#39;RUS&#39;</span>)
oly_country2 &lt;-<span class="st"> </span><span class="kw">filter</span>(oly_country, Country %in%<span class="st"> </span>country.list)</code></pre></div>
<p>Having completed this, we will now plot a time series plot by country for the last century.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(oly_country2, <span class="kw">aes</span>(Year,Medal,<span class="dt">group =</span> Country, <span class="dt">color =</span> Country)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;Summer Olympic Medals by Country&#39;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>This plot highlights a bit of the history of the summer Olympics. Note that Russia began competing in the 1950’s and China didn’t begin competing until the mid-1980’s. While the US has the longest sustained volume, Russia has the highest number in a single year (1980). While Great Britain had a surge at the turn of the century, it decreased to ~50 medals in the 1920’s and stayed near this mark for most of the century (as has France).</p>
</div>
<div id="practice-problem-2" class="section level2">
<h2><span class="header-section-number">3.5</span> Practice Problem</h2>
<p>Using the Olympic Data and Google, try to recreate the plot below with a horizontal barplot and bars ordered by volume of medals.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>Do your best to work this out on your own, but if you get stuck, use these hints to help you figure out what to do next.</p>
<ol style="list-style-type: decimal">
<li>The plot above indicates we will need medal counts by sport. We’ve done this before with the Korean Conflict data. Let’s adapt that code for our new purpose.</li>
</ol>
<pre><code># This code produced a histogram of Korean Conflict casualties 
# grouped by branch of service.

ggplot(kor, aes(BRANCH)) + geom_bar()</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Our new code should produce a histogram of Olympic medal winners </span>
<span class="co"># grouped by sport.</span>
<span class="kw">ggplot</span>(oly, <span class="kw">aes</span>(Sport)) +<span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>We’re not there yet, but we’re on the right track!</p>
<ol start="2" style="list-style-type: decimal">
<li>Let’s figure out the horizontal requirement for this histogram. This is a good time to point out some RStudio cheatsheets that are accessible from your RStudio interface. Go to the <code>Help</code> menu in RStudio, click <code>Cheatsheets</code>, and select the <code>Data Visualization with ggplot2</code> link. If you explore this sheet and/or do some quick Googling (“horizontal barplot in ggplot2”), you’ll find the command <code>coord_flip()</code>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(oly, <span class="kw">aes</span>(Sport)) +<span class="st"> </span><span class="kw">geom_bar</span>() +<span class="st"> </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>The example plot has blue bars. Let’s change that in our plot. Our cheatsheet says the <code>geom_bar()</code> command has <code>color</code> and <code>fill</code> options we could explore. It looks like <code>color</code> is the color of the rectangle edges, and <code>fill</code> is the color inside the rectangles. Let’s use a white border and a gray fill.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(oly, <span class="kw">aes</span>(Sport)) +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>) +<span class="st"> </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<p>It starting to look pretty good now. Let’s polish this plot with a title and better axes labels.</p>
<ol start="4" style="list-style-type: decimal">
<li>We have plenty of previous examples to copy some good title and axis label code. We can make our new plot look even better than the one we’re trying to replicate.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Note: the Medal Count is shown as the &quot;ylab&quot; instead of &quot;xlab&quot; because we used coord_flip()</span>
<span class="kw">ggplot</span>(oly, <span class="kw">aes</span>(Sport)) +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>) +<span class="st"> </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Summer Olympic Medals by Sport&#39;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Medal Count&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Mission accomplished!</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, and Winston Chang. 2017. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-data-manipulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-control-structures.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-visualization.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
